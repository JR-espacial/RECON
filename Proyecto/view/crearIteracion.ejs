<%- include('includes/openHTML.ejs'); %>

<% if (alerta) { %>
    <script>alert("Proyecto creado exitosamente");</script>
<% } %>

<div class="row">
    <div class="col s12 offset-s4">
        <form class="col s12" action="nueva-iteracion" method="POST">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>" >
            <div class="row">
                <div class="input-field col s4">
                    <select name="proyecto" id="selectProyecto" class="browser-default" required>
                        <option value="Crear proyecto">Crear proyecto</option>
                        <option value="" disabled selected>Selecciona el proyecto de la iteraci칩n</option>
                        <% for (let proyecto of proyectos) { %>
                            <option value="<%= proyecto.id_proyecto %>"><%= proyecto.nombre_proyecto %></option>
                        <% } %>
                      </select>
                </div>
            </div>
            <div class="row">
                <div class="input-field col s4">
                    <input  id="descripcion_proyecto" name="descripcion" type="text" class="validate">
                    <label for="descripcion_proyecto">Descripci칩n de la iteraci칩n</label>
                </div>
            </div>
            <div class="row">
                <div class="col s4">
                  <div class="row">
                    <div class="input-field col s12">
                      <i class="material-icons prefix ">search</i>
                      <input type="text" id="autocomplete-input" name="colaborador" class="autocomplete" placeholder="A침adir colaboradores">
                    </div>
                  </div>
                </div>
            </div>
            <div class="row">
                <div class="input-field col s4">
                    <input disabled value="Colaboradores:" type="text" id ="disabled" class="validate">
                </div>
            </div>
            <div class="row"> 
                <div id="contenedor_colaboradores" class="col s4 card-panel">
                    <span class="blue-text text-darken-2">Lista de colaboradores vacia</span>
                </div>
            </div>
            <div class="row">
                <div class="col s2 offset-s2">
                    <a class="waves-effect waves-light btn" id="cancelbtn" href="/proyectos/iteraciones-proyecto">Cancelar</a>
                    <input type="submit" value="Crear" >
                </div>
            </div>
        </form>
    </div>
</div>


<script>
    document.addEventListener('DOMContentLoaded', function() {
        var elems = document.querySelectorAll('select');
        var instances = M.FormSelect.init(elems);
    });

    let seleccion = document.getElementById("selectProyecto");
    seleccion.onchange= () => {
        if(seleccion.value == "Crear proyecto"){
            location.href = "nuevo-proyecto";
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
    let autocomplete = document.getElementById("autocomplete-input");
    
    let options = {};

    "<%for (let i = 0; i < empleados.length; i++) { %>"
         options["<%=empleados[i].nombre_empleado%>"] = null;
     "<% } %>"
    
      
    var instances = M.Autocomplete.init(autocomplete, { data : options });
      
    });

</script>

<%- include('includes/closeHTML.ejs'); %>